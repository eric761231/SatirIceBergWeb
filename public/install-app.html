<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å®‰è£å†¥æƒ³éŸ³æ¨‚æ‡‰ç”¨ç¨‹å¼</title>
  <link rel="icon" type="image/x-icon" href="../favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="../icons/icon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../icons/icon-16x16.png">
  <style>
    :root {
      --bg-primary: #131314;
      --bg-secondary: #1e1f20;
      --accent-cyan: #00aaff;
      --text-primary: #e8eaed;
      --text-secondary: #9aa0a6;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      color: var(--text-primary);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .header h1 {
      color: var(--accent-cyan);
      font-size: 28px;
      margin-bottom: 10px;
    }
    
    .header p {
      color: var(--text-secondary);
      font-size: 16px;
    }
    
    .install-steps {
      margin-bottom: 30px;
    }
    
    .step {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 4px solid var(--accent-cyan);
    }
    
    .step h3 {
      color: var(--accent-cyan);
      margin-bottom: 10px;
      font-size: 18px;
    }
    
    .step p {
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .step img {
      max-width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }
    
    .device-specific {
      background: rgba(0,170,255,0.1);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .device-specific h3 {
      color: var(--accent-cyan);
      margin-bottom: 15px;
      text-align: center;
    }
    
    .device-tabs {
      display: flex;
      margin-bottom: 20px;
      border-radius: 8px;
      overflow: hidden;
      background: var(--bg-primary);
    }
    
    .device-tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      background: transparent;
      color: var(--text-secondary);
    }
    
    .device-tab.active {
      background: var(--accent-cyan);
      color: var(--bg-primary);
    }
    
    .device-content {
      display: none;
    }
    
    .device-content.active {
      display: block;
    }
    
    .benefits {
      background: rgba(76, 175, 80, 0.1);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .benefits h3 {
      color: #4caf50;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .benefit-list {
      list-style: none;
    }
    
    .benefit-list li {
      padding: 8px 0;
      color: var(--text-secondary);
      position: relative;
      padding-left: 25px;
    }
    
    .benefit-list li::before {
      content: 'âœ“';
      position: absolute;
      left: 0;
      color: #4caf50;
      font-weight: bold;
    }
    
    .back-btn {
      display: inline-block;
      background: var(--accent-cyan);
      color: var(--bg-primary);
      padding: 12px 24px;
      border-radius: 25px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
    
    .back-btn:hover {
      background: #0099e6;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,170,255,0.3);
    }
    
    .install-btn {
      display: inline-block;
      background: #4caf50;
      color: white;
      padding: 15px 30px;
      border-radius: 25px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      font-size: 18px;
      margin-left: 15px;
    }
    
    .install-btn:hover {
      background: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(76,175,80,0.3);
    }
    
    .actions {
      text-align: center;
      margin-top: 30px;
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 20px;
        margin: 10px;
      }
      
      .header h1 {
        font-size: 24px;
      }
      
      .device-tabs {
        flex-direction: column;
      }
      
      .actions {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }
      
      .back-btn, .install-btn {
        margin: 0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“± å®‰è£å†¥æƒ³éŸ³æ¨‚æ‡‰ç”¨ç¨‹å¼</h1>
      <p>å°‡æ‡‰ç”¨ç¨‹å¼å®‰è£åˆ°æ‰‹æ©Ÿä¸»é é¢ï¼Œäº«å—æ›´å¥½çš„ä½¿ç”¨é«”é©—</p>
    </div>
    
    <div class="install-steps">
      <div class="step">
        <h3>ğŸ¯ ç‚ºä»€éº¼è¦å®‰è£æ‡‰ç”¨ç¨‹å¼ï¼Ÿ</h3>
        <p>å®‰è£å¾Œï¼Œæ‚¨å¯ä»¥ï¼š</p>
        <ul class="benefit-list">
          <li>åœ¨æ‰‹æ©Ÿä¸»é é¢ç›´æ¥é–‹å•Ÿæ‡‰ç”¨ç¨‹å¼</li>
          <li>æ¥æ”¶å†¥æƒ³æé†’é€šçŸ¥ï¼Œå³ä½¿æ‡‰ç”¨ç¨‹å¼æœªé–‹å•Ÿ</li>
          <li>äº«å—é›¢ç·šæ’­æ”¾åŠŸèƒ½</li>
          <li>ç²å¾—åŸç”Ÿæ‡‰ç”¨ç¨‹å¼èˆ¬çš„é«”é©—</li>
        </ul>
      </div>
    </div>
    
    <div class="device-specific">
      <h3>ğŸ“± å®‰è£èªªæ˜</h3>
      
      <div class="device-tabs">
        <button class="device-tab active" onclick="showDevice('android')">Android</button>
        <button class="device-tab" onclick="showDevice('ios')">iOS</button>
        <button class="device-tab" onclick="showDevice('desktop')">æ¡Œé¢ç‰ˆ</button>
      </div>
      
      <div id="android" class="device-content active">
        <h4>Android æ‰‹æ©Ÿå®‰è£æ­¥é©Ÿï¼š</h4>
        <ol>
          <li>ä½¿ç”¨ Chrome ç€è¦½å™¨é–‹å•Ÿå†¥æƒ³éŸ³æ¨‚é é¢</li>
          <li>é»æ“Šç€è¦½å™¨é¸å–®ï¼ˆä¸‰å€‹é»ï¼‰</li>
          <li>é¸æ“‡ã€Œå®‰è£æ‡‰ç”¨ç¨‹å¼ã€æˆ–ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</li>
          <li>é»æ“Šã€Œå®‰è£ã€ç¢ºèª</li>
          <li>æ‡‰ç”¨ç¨‹å¼å°‡å‡ºç¾åœ¨ä¸»é é¢ä¸Š</li>
        </ol>
      </div>
      
      <div id="ios" class="device-content">
        <h4>iPhone/iPad å®‰è£æ­¥é©Ÿï¼š</h4>
        <ol>
          <li>ä½¿ç”¨ Safari ç€è¦½å™¨é–‹å•Ÿå†¥æƒ³éŸ³æ¨‚é é¢</li>
          <li>é»æ“Šåº•éƒ¨çš„ã€Œåˆ†äº«ã€æŒ‰éˆ•</li>
          <li>é¸æ“‡ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</li>
          <li>é»æ“Šã€ŒåŠ å…¥ã€ç¢ºèª</li>
          <li>æ‡‰ç”¨ç¨‹å¼å°‡å‡ºç¾åœ¨ä¸»é é¢ä¸Š</li>
        </ol>
      </div>
      
      <div id="desktop" class="device-content">
        <h4>æ¡Œé¢ç‰ˆå®‰è£æ­¥é©Ÿï¼š</h4>
        <ol>
          <li>ä½¿ç”¨æ”¯æ´ PWA çš„ç€è¦½å™¨ï¼ˆChromeã€Edgeã€Firefoxï¼‰</li>
          <li>åœ¨ç¶²å€åˆ—å³å´æœƒå‡ºç¾å®‰è£åœ–æ¨™</li>
          <li>é»æ“Šå®‰è£åœ–æ¨™</li>
          <li>é¸æ“‡ã€Œå®‰è£ã€ç¢ºèª</li>
          <li>æ‡‰ç”¨ç¨‹å¼å°‡å‡ºç¾åœ¨é–‹å§‹é¸å–®å’Œæ¡Œé¢</li>
        </ol>
      </div>
    </div>
    
    <div class="benefits">
      <h3>âœ¨ å®‰è£å¾Œçš„åŠŸèƒ½</h3>
      <ul class="benefit-list">
        <li>æ‰‹æ©Ÿä¸»é é¢ç›´æ¥é–‹å•Ÿ</li>
        <li>èƒŒæ™¯æ¨é€é€šçŸ¥æé†’</li>
        <li>é›¢ç·šéŸ³æ¨‚æ’­æ”¾</li>
        <li>å…¨è¢å¹•æ²‰æµ¸é«”é©—</li>
        <li>å¿«é€Ÿå­˜å–æ’­æ”¾æ¸…å–®</li>
        <li>è‡ªå‹•æ›´æ–°å’ŒåŒæ­¥</li>
      </ul>
    </div>
    
    <div class="actions">
      <a href="../meditation.html" class="back-btn">è¿”å›éŸ³æ¨‚æ’­æ”¾å™¨</a>
      <button class="install-btn" onclick="installApp()">ç«‹å³å®‰è£</button>
    </div>
  </div>
  
  <script>
    // å…¨åŸŸè®Šæ•¸å„²å­˜å®‰è£æç¤º
    let deferredPrompt;
    
    // ç›£è½ beforeinstallprompt äº‹ä»¶
    window.addEventListener('beforeinstallprompt', (e) => {
      console.log('beforeinstallprompt äº‹ä»¶è§¸ç™¼');
      // é˜»æ­¢ç€è¦½å™¨é è¨­çš„å®‰è£æç¤º
      e.preventDefault();
      // å„²å­˜äº‹ä»¶ä»¥ä¾¿ç¨å¾Œä½¿ç”¨
      deferredPrompt = e;
      
      // é¡¯ç¤ºå®‰è£æŒ‰éˆ•
      const installBtn = document.querySelector('.install-btn');
      if (installBtn) {
        installBtn.style.display = 'inline-block';
        installBtn.textContent = 'ç«‹å³å®‰è£';
        installBtn.disabled = false;
      }
    });
    
    function showDevice(device) {
      // éš±è—æ‰€æœ‰å…§å®¹
      document.querySelectorAll('.device-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // ç§»é™¤æ‰€æœ‰æ¨™ç±¤çš„æ´»å‹•ç‹€æ…‹
      document.querySelectorAll('.device-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // é¡¯ç¤ºé¸ä¸­çš„å…§å®¹
      document.getElementById(device).classList.add('active');
      
      // è¨­ç½®é¸ä¸­æ¨™ç±¤çš„æ´»å‹•ç‹€æ…‹
      event.target.classList.add('active');
    }
    
    async function installApp() {
      try {
        console.log('é–‹å§‹å®‰è£æµç¨‹...');
        
        // æª¢æŸ¥æ˜¯å¦æ”¯æ´ Service Worker
        if ('serviceWorker' in navigator) {
          try {
            // è¨»å†Š Service Worker (ä¿®æ­£è·¯å¾‘)
            const registration = await navigator.serviceWorker.register('../service-worker.js');
            console.log('Service Worker è¨»å†ŠæˆåŠŸ:', registration);
          } catch (swError) {
            console.warn('Service Worker è¨»å†Šå¤±æ•—:', swError);
          }
        }
        
        // æª¢æŸ¥æ˜¯å¦æœ‰å®‰è£æç¤º
        if (deferredPrompt) {
          console.log('é¡¯ç¤ºå®‰è£æç¤º...');
          // é¡¯ç¤ºå®‰è£æç¤º
          deferredPrompt.prompt();
          
          // ç­‰å¾…ç”¨æˆ¶é¸æ“‡
          const { outcome } = await deferredPrompt.userChoice;
          console.log('ç”¨æˆ¶é¸æ“‡:', outcome);
          
          if (outcome === 'accepted') {
            alert('ğŸ‰ å®‰è£æˆåŠŸï¼æ‡‰ç”¨ç¨‹å¼å·²æ·»åŠ åˆ°æ‚¨çš„ä¸»é é¢ã€‚');
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            const installBtn = document.querySelector('.install-btn');
            if (installBtn) {
              installBtn.textContent = 'å·²å®‰è£';
              installBtn.disabled = true;
              installBtn.style.background = '#4caf50';
            }
          } else {
            alert('å®‰è£è¢«å–æ¶ˆã€‚æ‚¨å¯ä»¥ç¨å¾Œå†è©¦ã€‚');
          }
          
          // æ¸…é™¤ deferredPrompt
          deferredPrompt = null;
        } else {
          // æ²’æœ‰å®‰è£æç¤ºï¼Œæª¢æŸ¥æ˜¯å¦å·²å®‰è£
          if (window.matchMedia('(display-mode: standalone)').matches) {
            alert('âœ… æ‡‰ç”¨ç¨‹å¼å·²ç¶“å®‰è£ï¼');
            
            const installBtn = document.querySelector('.install-btn');
            if (installBtn) {
              installBtn.textContent = 'å·²å®‰è£';
              installBtn.disabled = true;
              installBtn.style.background = '#4caf50';
            }
          } else {
            // é¡¯ç¤ºæ‰‹å‹•å®‰è£èªªæ˜
            const isAndroid = /Android/i.test(navigator.userAgent);
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            
            if (isAndroid) {
              alert('ğŸ“± è«‹æŒ‰ç…§ä¸Šæ–¹ Android å®‰è£èªªæ˜æ‰‹å‹•å®‰è£æ‡‰ç”¨ç¨‹å¼ï¼š\n\n1. é»æ“Šç€è¦½å™¨é¸å–®ï¼ˆä¸‰å€‹é»ï¼‰\n2. é¸æ“‡ã€Œå®‰è£æ‡‰ç”¨ç¨‹å¼ã€æˆ–ã€ŒåŠ å…¥ä¸»ç•«é¢ã€\n3. é»æ“Šã€Œå®‰è£ã€ç¢ºèª');
            } else if (isIOS) {
              alert('ğŸ“± è«‹æŒ‰ç…§ä¸Šæ–¹ iOS å®‰è£èªªæ˜æ‰‹å‹•å®‰è£æ‡‰ç”¨ç¨‹å¼ï¼š\n\n1. é»æ“Šåº•éƒ¨çš„ã€Œåˆ†äº«ã€æŒ‰éˆ•\n2. é¸æ“‡ã€ŒåŠ å…¥ä¸»ç•«é¢ã€\n3. é»æ“Šã€ŒåŠ å…¥ã€ç¢ºèª');
            } else {
              alert('ğŸ’» è«‹æŒ‰ç…§ä¸Šæ–¹æ¡Œé¢ç‰ˆå®‰è£èªªæ˜æ‰‹å‹•å®‰è£æ‡‰ç”¨ç¨‹å¼ï¼š\n\n1. åœ¨ç¶²å€åˆ—å³å´æœƒå‡ºç¾å®‰è£åœ–æ¨™\n2. é»æ“Šå®‰è£åœ–æ¨™\n3. é¸æ“‡ã€Œå®‰è£ã€ç¢ºèª');
            }
          }
        }
      } catch (error) {
        console.error('å®‰è£å¤±æ•—:', error);
        alert('âŒ å®‰è£å¤±æ•—ï¼Œè«‹æŒ‰ç…§ä¸Šæ–¹èªªæ˜æ‰‹å‹•å®‰è£ã€‚');
      }
    }
    
    // é é¢è¼‰å…¥æ™‚æª¢æŸ¥å®‰è£ç‹€æ…‹
    document.addEventListener('DOMContentLoaded', () => {
      // æª¢æŸ¥æ˜¯å¦å·²å®‰è£
      if (window.matchMedia('(display-mode: standalone)').matches) {
        const installBtn = document.querySelector('.install-btn');
        if (installBtn) {
          installBtn.textContent = 'å·²å®‰è£';
          installBtn.disabled = true;
          installBtn.style.background = '#4caf50';
        }
      }
      
      // æª¢æŸ¥ç€è¦½å™¨æ”¯æ´
      if (!('serviceWorker' in navigator)) {
        console.warn('æ­¤ç€è¦½å™¨ä¸æ”¯æ´ Service Worker');
      }
      
      if (!('PushManager' in window)) {
        console.warn('æ­¤ç€è¦½å™¨ä¸æ”¯æ´æ¨é€é€šçŸ¥');
      }
    });
    
    // ç›£è½ appinstalled äº‹ä»¶
    window.addEventListener('appinstalled', (evt) => {
      console.log('æ‡‰ç”¨ç¨‹å¼å·²å®‰è£');
      alert('ğŸ‰ æ‡‰ç”¨ç¨‹å¼å®‰è£æˆåŠŸï¼');
      
      const installBtn = document.querySelector('.install-btn');
      if (installBtn) {
        installBtn.textContent = 'å·²å®‰è£';
        installBtn.disabled = true;
        installBtn.style.background = '#4caf50';
      }
    });
  </script>
</body>
</html>
